name: OSP-USERS - Create podman image (master)
run-name: Creating podman image (master) ðŸš€ (by ${{ github.actor }})
on: [push]
jobs:
  OSP-USERS-create-podman-image:
    runs-on: ubuntu-latest
    steps:
      - run: echo "Spinning up ${{ github.event_name }} on branch ${{ github.ref }} | os ${{ runner.os }}"
      - run: echo "ðŸ”Ž The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Clone repo
        uses: actions/checkout@v3
        with:
            ref: 'master'
      - name: List files
        run: |
          ls -la ${{ github.workspace }}
          pwd
      - name: Install packages
        run: |
          sudo apt-get install podman
          sudo apt-get install tar
      - name: create basic ubuntu container
        run: |
          podman pull ubuntu:latest
          podman run -ti -d --name osp-service-users -v ${{ github.workspace }}:/home:Z ubuntu:latest
          podman ps -a
      - name: CONTAINER - Install packages
        run: |
          podman attach osp-service-users
          podman exec osp-service-users apt-get -y update
          podman exec osp-service-users apt-get -y install curl
          podman exec osp-service-users curl https://get.volta.sh | bash
          podman exec osp-service-users volta install node@18.15.0
          podman exec osp-service-users node -v
          podman exec osp-service-users ls -la
          podman exec osp-service-users cd /home
          podman exec osp-service-users ls -la
      - name: Commit container and export image
        run: |
          podman commit osp-service-users
          podman images
          podman save --output produced-images.tar
          tar -xvf produced-images.tar
          ls -la



            

